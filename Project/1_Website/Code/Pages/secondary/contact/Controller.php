<?phprequire_once FILE_ACCESS_CORE_CODE.'/Framework/MVC_superClasses_Core/controllerSuperClass_Core/controllerSuperClass_Core.php';require_once('Model.php');require_once('View.php');require_once "Project/1_Website/Code/Pages/secondary/contact/module/recaptchalib.php";
class controller extends controllerSuperClass_Core
{		public function indexAction()	{		$view = new view();				$error = null;		$response = null;				//set recaptcha template		$recaptcha_template = recaptcha_get_html('6LeWyeESAAAAAHESj8krq8eNQG48wDULZMw1fyA9', $error);				//check if submit button is click		if(isset($_POST['submit']))		{			$email_status = $this->processRecaptcha();			$view->setStatus($email_status);		}				$view->setRecaptcha($recaptcha_template);				$url = $_SERVER['REQUEST_URI'];		$language = explode("/", $url);				if($language[1] == 'cn')			$view->displayChineseMainTemplate();		else			$view->displayMainTemplate();	}		private function processRecaptcha()	{		if (isset($_POST["recaptcha_response_field"])) 		{			$resp = recaptcha_check_answer ('6LeWyeESAAAAAI9_VouhIw2zecVkkWpj99BgZtDj',			$_SERVER["REMOTE_ADDR"],			$_POST["recaptcha_challenge_field"],			$_POST["recaptcha_response_field"]);					if ($resp->is_valid)			{				$this->sendMail();				return 'success';			} 			else 				return 'fail';		}   	}		private function sendMail()	{		require_once 'Project/1_Website/Code/Pages/secondary/contact/module/email.php';				$from_email = $_POST['email'];		$from_name	= $_POST['contactPerson'];		$subject = "spmi";		$body 		= "Company Name: {$_POST['companyName']}	<br />					   Contact Person: {$_POST['contactPerson']} <br />					   Street Address: {$_POST['streetAddress']} <br />					   City: {$_POST['city']} <br />					   State: {$_POST['state']} <br />					   Country: {$_POST['country']} <br />					   Phone: {$_POST['countryCode']} {$_POST['areaCode']} {$_POST['number']} <br />					   Fax: {$_POST['countryCodeFax']} {$_POST['areaCodeFax']} {$_POST['numberFax']} <br />					   Email: {$_POST['email']} <br />					   Website: {$_POST['website']} <br />					   Others: {$_POST['others']} <br /><br /><br />					  					   Message:  <br />						{$_POST['message']}										";								$to_email 	= "";		$to_name 	= "";				email::send_email($to_email, $to_name, $from_email, $from_name, $subject, $body, '', '', '');	}	}?>